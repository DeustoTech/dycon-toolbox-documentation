<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  
    <title>Dircet Methods - DyCon Toolbox</title>

    
  

  <link rel="shortcut icon" href="https://deustotech.github.io/dycon-toolbox-documentation/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="https://deustotech.github.io/dycon-toolbox-documentation/assets/css/just-the-docs.css">

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-2709176-10', 'https://deustotech.github.io');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
  

  
    <script type="text/javascript" src="https://deustotech.github.io/dycon-toolbox-documentation/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="https://deustotech.github.io/dycon-toolbox-documentation/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Dircet Methods | DyCon Toolbox</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Dircet Methods" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="DyCon Toolbox Documentation" />
<meta property="og:description" content="DyCon Toolbox Documentation" />
<link rel="canonical" href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T043_DirectMethod/" />
<meta property="og:url" content="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T043_DirectMethod/" />
<meta property="og:site_name" content="DyCon Toolbox" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T043_DirectMethod/","headline":"Dircet Methods","description":"DyCon Toolbox Documentation","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      },
      extensions: ["AMSmath.js", "AMSsymbols.js"],
      Macros:{
        Y: "\\textbf{Y}",
        dY: "\\dot{\\textbf{Y}}",
        U: "\\textbf{U}",
      }
    },
    CommonHTML: {
      styles: {
        "@font-face /* vec */ ": {
          "font-family": "MJX-VEC",
          src: [
            "url(data:application/x-font-woff;charset=utf-8;base64,",
            "d09GRgABAAAAAARMAA0AAAAABiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEMAAAABwA",
            "AAAccRGLqUdERUYAAAQMAAAAJAAAACgANAAmT1MvMgAAAaAAAABJAAAAYFc5gfFjbWFwAAACAAAA",
            "AEYAAAFKQxjlbWdhc3AAAAQEAAAACAAAAAj//wADZ2x5ZgAAAlQAAACUAAAAlIQU9HBoZWFkAAAB",
            "MAAAADAAAAA2C748e2hoZWEAAAFgAAAAHgAAACQFXQDqaG10eAAAAewAAAAUAAAAFAYvAE9sb2Nh",
            "AAACSAAAAAwAAAAMACgAcm1heHAAAAGAAAAAHQAAACAASQAmbmFtZQAAAugAAADxAAAB5uwlD0hw",
            "b3N0AAAD3AAAACgAAAA34M9aEXjaY2BkYGAA4uOfgq7G89t8ZeBmfgEUYbga+icNTssClVxnOgXk",
            "cjAwgUQBdqEMW3jaY2BkYGBu+feBgYHxCwMQMF5nYGRABawAcaQESgAAeNpjYGRgYGBlUGZgYgAB",
            "EMnIABJzAPMZAAZZAHAAAAB42mNgYSxn/MLAysDA1MW0h4GBoQdCMz5gMGRkAooysDEzwAAjECvA",
            "OAFprikMBxgUFCcxt/z7wMDA3MIoAFUDAwoMjACD8Qv5AAAAAfQAMgAAAAABTQAAAPoAAAH0AB14",
            "2mNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYFBQn/f8P5IPp/4/vFUHVAwEjGwOcw8gEJJgY",
            "UAEjxIrhDACLGwmnAAAAAAAUABQAFAAUAEoAAgAyAAABwgIVAAMABwAAMxEhESUhESEyAZD+ogEs",
            "/tQCFf3rMgGxAAEAHQIEAdcCygAiAAABNDYzMhcWFxYXFhUUBgcGBw4DIyImNTQ3IycmNTQ3ISYB",
            "eQsJBwUFBQofCwYLKyACBwMGBAcNL6urDQ0BZxgCtggMBQQPJRQHCwkGBhYpAgkCAgsJEygBCQoH",
            "DSYAeNqVjrGKwkAURe/EGBBUrG12CishMrFQcDuLsAi26YMOmsIMxAh+hN8i+CF+gd+y4B3zttjC",
            "woHhncu7774HoI8rFP5eIKzQw5dwgAjfwi2McBEO6bkLtzHAr3CEnhrTqcKOpDasMCQ1HKCLWLiF",
            "HyyFQ3puwm1oPIQjDFXfR62Ro8YeK9YzMlhsqB0qtvJ6v8rPmd3Uzkv2tihwwoHCbosTa0pryYH0",
            "NbKjRWPB/z626Se8dsY/hSHPGeTKOnXVzuqF/reYOoln8dQk80+u9b0KR97rD9Rc4xdNXtVQI7PV",
            "sXClNiaZGGP0B+FPMN1KMAAAAHjaY2BiAIP/zQxGDNgAKxAzMjAxMDMycSUWFeWXF2WmZ5QAAGh5",
            "BhgAAAAB//8AAnjaY2BkYGDgA2IJBgUgycTAyMDMwAIkWcA8BgZGCAYACgIAWwAAAAEAAAAAxmW3",
            "ygAAAADVVeemAAAAANVV7Dg=) format('woff')"
          ].join('')
        },
        ".MJX-VEC": {
          "font-family": "MJX-VEC"
        }
      }
    }
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>
</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
          <center>
              <a href="https://deustotech.github.io/dycon-toolbox-documentation/" class="site-title fs-6 lh-tight">
                <img src="https://deustotech.github.io/dycon-toolbox-documentation/assets/images/logo.png" width="70%"></img>
              </a>
          </center>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/" class="navigation-list-link">Home</a>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/02-Download/" class="navigation-list-link">Download</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/025-GettingStarted/" class="navigation-list-link">Getting Started</a>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/03-DynamicsInterface/T03_DynamicsInterface/" class="navigation-list-link">Interface for Dynamics (ODEs)</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/03-DynamicsInterface/T031_BasicExample/" class="navigation-list-link">Basic example of dynamics objects</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/03-DynamicsInterface/T032_SeveralSolvers/" class="navigation-list-link">Choose a differents solvers</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T04_PontryaginProblems/" class="navigation-list-link">Pontryagin Problems</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T041_BasicExample/" class="navigation-list-link">Basic example of Pontryagin Problems</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T042_IndirectMethods/" class="navigation-list-link">Indirect Methods</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item  active">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T043_DirectMethod/" class="navigation-list-link active">Dircet Methods</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T044_TunelSolvers/" class="navigation-list-link">Tunel for Other Solvers</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/05-SpecializedTools/T05-SpecializedTools/" class="navigation-list-link">Specialized Tools</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/05-SpecializedTools/T051-LQR/" class="navigation-list-link">Lineal Quadratic Regulator</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/05-SpecializedTools/T052-LsNorm/" class="navigation-list-link">Ls norm</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/05-SpecializedTools/T053_HUM/" class="navigation-list-link">HUM</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/05-SpecializedTools/T054-InverseProblems/" class="navigation-list-link">Inverse Problems</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/T06-Examples/" class="navigation-list-link">Examples</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/ODE/061-ODE-Examples/" class="navigation-list-link">ODE Examples</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/ODE/T06ODET0001_robot/" class="navigation-list-link">Robot</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/ODE/T06ODET0002_spin/" class="navigation-list-link">Rotor Control</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/ODE/T06ODET0003_timeOptimization/" class="navigation-list-link">Time Optimization in Guidance by replusion</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/ODE/T06ODET0004_Kuramoto/" class="navigation-list-link">The Optimal control on the Kuramoto adaptative coupling model</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/061-PDE-Examples/" class="navigation-list-link">PDE Examples</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0000_FractionalLaplacianDynamics/" class="navigation-list-link">Fractional Laplacian Dynamics</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0003_Laplacian/" class="navigation-list-link">Control of Heat Equation</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0004_FractionalLaplacian/" class="navigation-list-link">Control of Fractional Heat Equation</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0007_semilinear/" class="navigation-list-link">Control for a semilinear heat equation and analogies with a collective behavior model</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0008_NormInf/" class="navigation-list-link">Infinite Norm</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0009_2dHeat/" class="navigation-list-link">Heat Equation 2D</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/06-Examples/PDE/T0010_sl_constraints/" class="navigation-list-link">Population Dynamics</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/07-API-docs/07-API-docs/" class="navigation-list-link">API docs</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/07-API-docs/classes/classes/" class="navigation-list-link">classes</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                              <li class="navigation-list-item ">
                                <a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/07-API-docs/classes/ode/0001-01-01-Classode/" class="navigation-list-link">ode</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">
            The DyCon Toolbox is developed primarily by the <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>, at <a href="http://deustotech.deusto.es/">DeustoTech</a>. Contact the DyCon Toolbox developer team <a href="mailto:dycon-dev-group@deusto.es">dycon-dev-group@deusto.es</a> for more information.
        </p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search DyCon Toolbox" aria-label="Search DyCon Toolbox" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                <li class="d-inline-block">
                      <div align="right">
                          Visit ↠  <a href="https://cmc.deusto.eus/">
                          Chair of Computational Mathematics
                        </a>

                        </div>
                </li>
            </ul>
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="https://deustotech.github.io/dycon-toolbox-documentation/posts/04-PontryaginProblems/T04_PontryaginProblems/">Pontryagin Problems</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>Dircet Methods</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          
          <h1>Dircet Methods</h1>
          <p>Instead of the Gradient method in the DyCon Toolbox, we may use Matlab built-in functions such as ‘fmincon’ or ‘fminunc’ for the optimizations. In this tutorial, we test ‘fmincon’ and ‘GradientMethod’ with the example ‘Problem 6.3’ in the following paper:</p>

<p>[1] : E. R. Edge and W. F. Powers. “Function-space quasi-Newton algorithms for optimal control problems with bounded controls and singular arcs.” Journal of Optimization Theory and Applications 20.4 (1976): 455-479.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clear</span>

<span class="n">syms</span> <span class="n">x1</span> <span class="n">x2</span> <span class="n">x3</span> <span class="n">x4</span> <span class="n">u1</span> <span class="n">t</span>

<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">;</span> <span class="n">x2</span><span class="p">;</span> <span class="n">x3</span><span class="p">;</span> <span class="n">x4</span><span class="p">];</span>
<span class="n">U</span> <span class="o">=</span> <span class="p">[</span><span class="n">u1</span><span class="p">];</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>      <span class="mi">5</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">;</span>
       <span class="o">-</span><span class="mi">5</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">;</span>
        <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span>   <span class="mi">10</span><span class="p">;</span>
        <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>  <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">];</span>

<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">];</span>

<span class="n">dynamics</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">U</span><span class="p">;</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">matlabFunction</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span><span class="s1">'Vars'</span><span class="p">,{</span><span class="n">t</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">sym</span><span class="o">.</span><span class="nb">empty</span><span class="p">});</span>
<span class="n">Nt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">4.2</span><span class="p">;</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">;</span> <span class="mi">10</span><span class="p">;</span> <span class="mi">10</span><span class="p">;</span> <span class="mi">10</span><span class="p">];</span>
</code></pre></div></div>

<p>We choose solver ‘ode23tb’ to cover the stiff nature of the equations.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iode</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">);</span>
<span class="n">iode</span><span class="o">.</span><span class="n">InitialCondition</span> <span class="o">=</span> <span class="n">Y0</span><span class="p">;</span>
<span class="n">iode</span><span class="o">.</span><span class="n">Solver</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ode23</span><span class="p">;</span>
<span class="n">iode</span><span class="o">.</span><span class="n">FinalTime</span> <span class="o">=</span> <span class="n">T</span><span class="p">;</span>
<span class="n">iode</span><span class="o">.</span><span class="n">Nt</span> <span class="o">=</span> <span class="n">Nt</span><span class="p">;</span>

<span class="n">Psi</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="p">(</span><span class="n">Y</span><span class="o">'*</span><span class="n">Y</span><span class="p">);</span>
<span class="n">L</span>   <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span>

<span class="n">iCP</span> <span class="o">=</span> <span class="n">Pontryagin</span><span class="p">(</span><span class="n">iode</span><span class="p">,</span><span class="n">Psi</span><span class="p">,</span><span class="n">L</span><span class="p">);</span>
</code></pre></div></div>

<p>After we defined ‘Pontryagin’ class, we may use the function ‘Control2Functional’ to indicate the cost as a function of the control. In this way, we may impliment ‘fmincon’. The maximum and minimum of the control are given by -1 and 1.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">U0</span> <span class="o">=</span> <span class="n">iode</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">Numeric</span><span class="p">;</span>
<span class="n">Umax</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">iode</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">Numeric</span><span class="p">));</span>
<span class="n">Umin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">iode</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">Numeric</span><span class="p">));</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">optimoptions</span><span class="p">(</span><span class="o">@</span><span class="n">fmincon</span><span class="p">,</span><span class="s1">'display'</span><span class="p">,</span><span class="s1">'iter'</span><span class="p">,</span><span class="s1">'SpecifyObjectiveGradient'</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="p">[</span><span class="n">U1_tspan</span><span class="p">,</span><span class="n">J1_optimal</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmincon</span><span class="p">(</span><span class="o">@</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="n">Control2Functional</span><span class="p">(</span><span class="n">iCP</span><span class="p">,</span><span class="n">U</span><span class="p">),</span><span class="n">U0</span><span class="p">,[],[],[],[],</span><span class="n">Umin</span><span class="p">,</span><span class="n">Umax</span><span class="p">,[],</span><span class="n">options</span><span class="p">);</span>
<span class="c1">%%[U1_tspan,J1_optimal] = fminunc(@(U)Control2Functional(iCP,U),U0,options);</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0       1    4.226202e+00    0.000e+00    1.152e-01
    1       2    3.923764e+00    0.000e+00    1.091e-01    5.019e-01
    2       3    2.577178e+00    0.000e+00    7.862e-02    2.524e+00
    3       4    2.257460e+00    0.000e+00    6.667e-02    6.987e-01
    4       5    2.025004e+00    0.000e+00    7.305e-02    6.217e-01
    5       6    1.854776e+00    0.000e+00    7.797e-02    5.797e-01
    6       7    1.728235e+00    0.000e+00    8.178e-02    5.349e-01
    7       8    1.606103e+00    0.000e+00    8.566e-02    5.413e-01
    8       9    1.551198e+00    0.000e+00    8.747e-02    2.647e-01
    9      10    1.467688e+00    0.000e+00    9.028e-02    5.065e-01
   10      11    1.415788e+00    0.000e+00    9.211e-02    3.775e-01
   11      12    1.366385e+00    0.000e+00    9.393e-02    3.665e-01
   12      13    1.307117e+00    0.000e+00    9.619e-02    4.706e-01
   13      14    1.264573e+00    0.000e+00    9.793e-02    4.183e-01
   14      15    1.233036e+00    0.000e+00    6.167e-02    4.142e-01
   15      16    1.205619e+00    0.000e+00    4.012e-02    3.222e-01
   16      17    1.180792e+00    0.000e+00    4.043e-02    3.275e-01
   17      18    1.163971e+00    0.000e+00    4.046e-02    2.901e-01
   18      19    1.151355e+00    0.000e+00    4.062e-02    2.115e-01
   19      20    1.132852e+00    0.000e+00    3.187e-02    3.602e-01
   20      21    1.126697e+00    0.000e+00    2.871e-02    1.708e-01
   21      22    1.112628e+00    0.000e+00    2.793e-02    3.689e-01
   22      23    1.099486e+00    0.000e+00    2.766e-02    3.610e-01
   23      24    1.098810e+00    0.000e+00    1.570e-02    7.308e-02
   24      25    1.095231e+00    0.000e+00    9.232e-03    1.573e-01
   25      26    1.091548e+00    0.000e+00    7.579e-03    1.690e-01
   26      27    1.089355e+00    0.000e+00    6.429e-03    1.494e-01
   27      28    1.087930e+00    0.000e+00    6.434e-03    1.225e-01
   28      29    1.085041e+00    0.000e+00    6.431e-03    1.596e-01
   29      30    1.081792e+00    0.000e+00    6.425e-03    1.769e-01
   30      31    1.080402e+00    0.000e+00    5.279e-03    1.140e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31      32    1.078796e+00    0.000e+00    5.278e-03    1.026e-01
   32      33    1.077619e+00    0.000e+00    5.283e-03    9.718e-02
   33      34    1.076969e+00    0.000e+00    3.744e-03    8.794e-02
   34      35    1.076075e+00    0.000e+00    3.052e-03    8.412e-02
   35      36    1.075294e+00    0.000e+00    2.966e-03    6.984e-02
   36      38    1.075067e+00    0.000e+00    2.794e-03    2.911e-02
   37      40    1.074863e+00    0.000e+00    2.440e-03    3.835e-02
   38      53    1.074851e+00    0.000e+00    1.053e-03    7.734e-04
   39      54    1.020800e+00    0.000e+00    2.464e-03    6.191e-01
   40      55    1.011180e+00    0.000e+00    2.920e-03    1.146e-01
   41      56    1.006900e+00    0.000e+00    3.204e-03    2.396e-01
   42      57    1.005615e+00    0.000e+00    3.317e-03    1.395e-01
   43      58    1.005155e+00    0.000e+00    3.445e-03    2.101e-01
   44      59    1.004241e+00    0.000e+00    3.541e-03    1.282e-01
   45      60    1.004087e+00    0.000e+00    1.643e-03    2.665e-02
   46      62    1.004015e+00    0.000e+00    1.630e-03    1.160e-02
   47      63    1.003804e+00    0.000e+00    1.613e-03    2.960e-02
   48      64    1.003466e+00    0.000e+00    1.593e-03    2.356e-02

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current step is less than
the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.


</code></pre></div></div>

<p>We can solve the same control problem using ‘GradientMethod’.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iCP</span><span class="o">.</span><span class="n">Constraints</span><span class="o">.</span><span class="n">MaxControl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">iCP</span><span class="o">.</span><span class="n">Constraints</span><span class="o">.</span><span class="n">MinControl</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

<span class="n">U0</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">iCP</span><span class="o">.</span><span class="n">Dynamics</span><span class="o">.</span><span class="n">Nt</span><span class="p">,</span><span class="n">iCP</span><span class="o">.</span><span class="n">Dynamics</span><span class="o">.</span><span class="n">ControlDimension</span><span class="p">);</span>
<span class="n">GradientMethod</span><span class="p">(</span><span class="n">iCP</span><span class="p">,</span><span class="n">U0</span><span class="p">,</span><span class="s1">'Graphs'</span><span class="p">,</span><span class="nb">false</span><span class="p">,</span><span class="s1">'DescentAlgorithm'</span><span class="p">,</span><span class="o">@</span><span class="n">AdaptativeDescent</span><span class="p">,</span><span class="s1">'display'</span><span class="p">,</span><span class="s1">'all'</span><span class="p">)</span>
<span class="n">U2_tspan</span> <span class="o">=</span> <span class="n">iCP</span><span class="o">.</span><span class="n">Solution</span><span class="o">.</span><span class="n">UOptimal</span><span class="p">;</span>
<span class="n">J2_optimal</span> <span class="o">=</span> <span class="n">iCP</span><span class="o">.</span><span class="n">Solution</span><span class="o">.</span><span class="n">JOptimal</span><span class="p">;</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    "error = 5.647307e+01 | Functional = 3.267927e+00 | norm(Gradient) = 1.295183e+01 | norm(U) = 1.662327e+00 | iter = 5"

    "error = 5.259393e+00 | Functional = 9.972504e-01 | norm(Gradient) = 7.210203e+00 | norm(U) = 9.473084e+00 | iter = 10"

    "error = 4.960797e+00 | Functional = 9.830185e-01 | norm(Gradient) = 7.170901e+00 | norm(U) = 9.963379e+00 | iter = 15"

    "error = 4.963533e+00 | Functional = 9.828142e-01 | norm(Gradient) = 7.172717e+00 | norm(U) = 9.961282e+00 | iter = 17"


    Solve with precision: 

        We obtain: J(u) = 9.828142E-01

        error = 4.963533E+00

    With 17 iterations,     In 7.3344 seconds


</code></pre></div></div>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">iode</span><span class="o">.</span><span class="n">tspan</span><span class="p">,[</span><span class="n">U1_tspan</span><span class="p">,</span><span class="n">U2_tspan</span><span class="p">])</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Control'</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">([</span><span class="s1">'Solution of fmincon, cost='</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="n">J1_optimal</span><span class="p">)],[</span><span class="s1">'Solution of GradientMethod, cost='</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="n">J2_optimal</span><span class="p">)])</span>
</code></pre></div></div>

<p><img src="https://deustotech.github.io//dycon-toolbox-documentation/assets/imgs/04-PontryaginProblems/T043/copiaRM_01.png" alt="" /></p>


          <p></p>
          <hr></div>
      </div>
    </div>
  </div>

</body>
</html>
