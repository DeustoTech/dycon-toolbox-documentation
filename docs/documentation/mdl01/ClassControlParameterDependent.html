<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">



	<link rel='shortcut icon' type='image/png' href='/dycon-platform-documentation/favicon.png' />

    <title>ControlParameterDependent - DyCon Platform</title>

    <link rel="canonical" href="https://DeustoTech.github.io/dycon-platform-documentation/documentation/mdl01/ClassControlParameterDependent">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/css/clean-blog.css">

	<!-- Adjust Colors -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/colorscheme.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
  	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
  	<link href="https://fonts.googleapis.com/css?family=Lusitana" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<!-- Math Jax -->
	<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']]
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    /*CommonHTML: {
      scale: 300
    }*/
	});
	</script>

	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
    <script src="https://DeustoTech.github.io/dycon-platform-documentation/js/clean-blog.min.js "></script>
    
 	<!-- 404  JavaScript -->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/dycon-platform-documentation/">
                 <img src="https://DeustoTech.github.io//dycon-platform-documentation/assets/logo_DyConToolbox_v001.png" >
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/dycon-platform-documentation/">Home</a>
                </li>
                
                
                <li>
                    <a href="/dycon-platform-documentation/projects/documentation">Documentation</a>
                </li>
                
                
                
                
                
                <li>
                    <a href="/dycon-platform-documentation/projects/tutorials">Tutorials</a>
                </li>
                
                
                
                <li>
                    <a href="/dycon-platform-documentation/Download">Downloads</a>
                </li>
                
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="container" style="padding-top: 70px;">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading" style="padding: 0px 0">
                    <h1 class="post-title">ControlParameterDependent <small>Class</small></h1>
				</div>
				
				<h2>Description</h2>
				The goal of this class is to solve optimal control problems where the states are defined via finite dimensional parameter-dependent systems of the form $$\dot{x}(t,\nu)=A(\nu)x(t,\nu)+B(\nu)u(t), \, t>T, \quad x(0)=x0,$$ being $\nu$ the parameter that can be discrete or continuous. Different iterative algorithms based on gradient descent methods are performed to reach this objective. For example, the classical gradient descent technique or stochastic gradient descent method, which has become important in the last years.

                <h2>Example</h2>
				<p>The optimal control of the following functional is obtained applying the classical gradient descent algorithm</p>

<script type="math/tex; mode=display">\begin{equation*} \min_{u \in L^2(0,T)} \mathcal{J}\left( u\right) = \min_{u \in L^2(0,T)} \frac{1}{2} \left[ \frac{1}{|\mathcal{K}|} \sum_{\nu \in \mathcal{K}} x \left( T, \nu \right) - \bar{x} \right]^2  + \frac{\beta}{2} \int_0^T u^2 \mathrm{d}t, \quad \beta \in \mathbb{R}^+ \end{equation*}</script>

<p>Subject to the finite dimensional linear control system</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}  \left\{ \begin{array}{ll} x^\prime \left( t \right) = A \left( \nu \right) x \left( t \right) + B \left( \nu \right) u \left( t \right), \quad 0 < t <T, \\ x\left( 0 \right) = x^0. \end{array} \right. \end{align*} %]]></script>

<p>the goal is to apply the stochastic gradient descent method to obtain the minimun of the same optimal control problem.</p>

<p>In this case, the iterative method is defined as</p>

<script type="math/tex; mode=display">\begin{equation*} u^{\left( k+1 \right)} = u^{\left( k \right)} - \gamma \left( \beta u^{\left( k \right)}- B^{\top}p \left( t,\nu_{i_k} \right) \right), \end{equation*}</script>

<p>where $p \left( t,\nu_{i_k} \right)$ is solution of the following adjoint problem</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*} \left\{ \begin{array}{ll} p^\prime \left( t, \nu \right) = -A \left( \nu \right) p \left( t,\nu \right), \quad 0 < t <T, \\ \displaystyle p\left( T \right) = - \left[ \frac{1}{|\mathcal{K}|} \sum_{\nu \in \mathcal{K}} x \left( T, \nu \right) - \bar{x} \right]. \end{array} \right. \end{align*} %]]></script>

<p>The values of parameter $\nu_i$ are</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nu</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<p>And save in K, the number of values</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">K</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">nu</span><span class="p">);</span>
</code></pre></div></div>

<p>We can, define the initial state of all ODE’s</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">% dimension of vector state</span>
<span class="n">x0</span> <span class="o">=</span> <span class="nb">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<p>We take as final target</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xt</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">;</span><span class="mi">0</span><span class="p">];</span>
</code></pre></div></div>

<p>Also, we need to define a initial control, that will be evolve</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">;</span> <span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">T</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">span</span> <span class="o">=</span> <span class="p">(</span><span class="n">t0</span><span class="p">:</span><span class="n">dt</span><span class="p">:</span><span class="n">T</span><span class="p">);</span>
<span class="c1">%</span>
<span class="n">u0</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">span</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<p>Moreover, we can define the matrix A’s and B’s, that determine the linear system</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Am</span> <span class="o">=</span> <span class="o">-</span><span class="nb">triu</span><span class="p">(</span><span class="nb">ones</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>
</code></pre></div></div>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Bm</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">Bm</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">);</span>
<span class="n">B</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">);</span>
<span class="k">for</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">K</span>
    <span class="n">A</span><span class="p">(:,:,</span><span class="n">index</span><span class="p">)</span> <span class="o">=</span> <span class="n">Am</span> <span class="o">+</span> <span class="p">(</span><span class="n">nu</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">*</span><span class="nb">diag</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">Am</span><span class="p">));</span>
    <span class="n">B</span><span class="p">(:,:,</span><span class="n">index</span><span class="p">)</span> <span class="o">=</span> <span class="n">Bm</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Then, we solve the problem applying the stochastic gradient descent algorithm</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AverageProblemSG</span> <span class="o">=</span> <span class="n">ControlParameterDependent</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">span</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AverageStochasticGradient</span><span class="p">(</span><span class="n">AverageProblemSG</span><span class="p">,</span><span class="n">xt</span><span class="p">)</span>
</code></pre></div></div>

<p>You can see the results</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">AverageProblemSG</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://DeustoTech.github.io//dycon-platform-documentation/assets/imgs/MDL01/class/main/ControlParameterDependent/copiaRM_01.png" alt="" /></p>




				<h1>Properties</h1>
				<table>
					<tr>
						<th>Name</th>
            <th>Type</th>
            <th>Default Value</th>
            <th>Description</th>
					</tr>
					
						<tr>
							<th>N</th>
							<th>Numeric value</th>
							<th>none</th>
							<th>Number of states of the system</th>
						</tr>
					
						<tr>
							<th>A</th>
							<th>Matrix</th>
							<th>none</th>
							<th>$N\times N$ matrix governing the free dynamics of the system</th>
						</tr>
					
						<tr>
							<th>B</th>
							<th>Matrix</th>
							<th>none</th>
							<th>$N\times M$ matrix. Control operator</th>
						</tr>
					
						<tr>
							<th>x0</th>
							<th>Vector</th>
							<th>none</th>
							<th>Vector with the initial states</th>
						</tr>
					
						<tr>
							<th>u0</th>
							<th>Vector</th>
							<th>none</th>
							<th>Vector dimension initial value of the control</th>
						</tr>
					
						<tr>
							<th>span</th>
							<th>Vector</th>
							<th>none</th>
							<th>Vector of time</th>
						</tr>
					
						<tr>
							<th>K</th>
							<th>Numerical value</th>
							<th>none</th>
							<th>Length of the parameter $\nu$</th>
						</tr>
					
						<tr>
							<th>addata</th>
							<th>Numerical value</th>
							<th>none</th>
							<th>Aditional data of gradient methods. You can find the history </th>
						</tr>
					
						<tr>
							<th>u</th>
							<th>Numerical value</th>
							<th>none</th>
							<th>Control Obtain</th>
						</tr>
					
				</table>
        <!-- CONSTRUCTOR  -->
				<h1>Contructor</h1>
				<h3>Mandatory Input Parameters</h3>
				<table>
					<tr>
						<th>Name</th>
						<th>Description</th>
						<th>class</th>
					</tr>
					
						<tr>
							<th>iode</th>
							<th>Ordinary Differential Equation represent the constrain to minimize the functional. It is a finite dimensional parameter-dependent linear system of ordinary differential equations."</th>
							<th>ode</th>
						</tr>
					
						<tr>
							<th>Jfun</th>
							<th>Cost function to obtain the optimal control</th>
							<th>Functional</th>
						</tr>
					

				</table>

				<!-- OPTIONAL INPUTS  -->

				
					<h3>Optional Input Parameters</h3>
					<table>
						<tr>
							<th>Name</th>
							<th>Description</th>
							<th>class</th>
						</tr>
						
							<tr>
								<th>T</th>
								<th>This parameter represent the final time of simulation.</th>
								<th>double</th>
							</tr>
						
							<tr>
								<th>dt</th>
								<th>This parameter represent is the interval to interpolate the control u and state y to obtain the functional</th>
								<th>double</th>
							</tr>
						
					</table>
				

				<!--  OUTPUTS -->
				
					<h3>Output Parameters</h3>
					<table>
						<tr>
							<th>Name</th>
							<th>Description</th>
							<th>class</th>
						</tr>
						
						<tr>
							<th>obj</th>
							<th>Control Prameter Dependent Class</th>
							<th></th>
						</tr>
						
					</table>
				


				<h1>Methods</h1>
				<table>
					<tr>
						<th>Name</th>
						<th>Description</th>
					</tr>
					
					  
					
					  
						<tr>
							<th><a href="/dycon-platform-documentation/documentation/mdl01/ControlParameterDependent/AverageClassicalGradient">AverageClassicalGradient</a></th>
							<th>The Average Classical Gradient solves an optimal control problem</th>
						</tr>
					  
					
					  
						<tr>
							<th><a href="/dycon-platform-documentation/documentation/mdl01/ControlParameterDependent/AverageConjugateGradient">AverageConjugateGradient</a></th>
							<th>This function solve a particular optimal control problem using the stochastic gradient descent algorithm.</th>
						</tr>
					  
					
					  
						<tr>
							<th><a href="/dycon-platform-documentation/documentation/mdl01/ControlParameterDependent/AverageStochasticGradient">AverageStochasticGradient</a></th>
							<th>This function solves a particular optimal control problem using the stochastic gradient descent algorithm.</th>
						</tr>
					  
					
					  
						<tr>
							<th><a href="/dycon-platform-documentation/documentation/mdl01/ControlParameterDependent/SimultaneousStochasticGradient">SimultaneousStochasticGradient</a></th>
							<th></th>
						</tr>
					  
					
					  
						<tr>
							<th><a href="/dycon-platform-documentation/documentation/mdl01/ControlParameterDependent/animation">animation</a></th>
							<th>This method allows us to see an animation of the evolution of gradient methods, shows the controls in each iteration with a lapse of $dt=0.15s$</th>
						</tr>
					  
					
					  
						<tr>
							<th><a href="/dycon-platform-documentation/documentation/mdl01/ControlParameterDependent/plot">plot</a></th>
							<th>The plot function applied to a ControlParameterDepent object shows  the evolution of optimization</th>
						</tr>
					  
					
				</table>


            </div>
        </div>
    </div>
</header>


    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          <li>
            <img style="width: 200px;" src="/dycon-platform-documentation/img/logos/logo_DyCon.png " alt="">
          </li>
          <li>
            <img style="width: 250px;" src="/dycon-platform-documentation/img/logos/logo_CCM_subDerecha_v002.png " alt="">
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>


</body>

</html>
