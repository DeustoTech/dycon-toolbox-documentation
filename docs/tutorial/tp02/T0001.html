<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">



	<link rel='shortcut icon' type='image/png' href='/dycon-platform-documentation/favicon.png' />

    <title>First Example - DyCon Toolbox</title>

    <link rel="canonical" href="https://DeustoTech.github.io/dycon-platform-documentation/tutorial/tp02/T0001">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/css/clean-blog.css">

	<!-- Adjust Colors -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/colorscheme.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="https://DeustoTech.github.io/dycon-platform-documentation/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
  	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
  	<link href="https://fonts.googleapis.com/css?family=Lusitana" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<!-- Math Jax -->
	<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']]
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    }
	});
	</script>

	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
    <script src="https://DeustoTech.github.io/dycon-platform-documentation/js/clean-blog.min.js "></script>
    
 	<!-- 404  JavaScript -->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/dycon-platform-documentation/">
                 <img src="https://DeustoTech.github.io//dycon-platform-documentation/assets/logo_DyConToolbox_v001.png" >
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/dycon-platform-documentation/">Home</a>
                </li>
                
                
                <li>
                    <a href="/dycon-platform-documentation/projects/01-documentation">Documentation</a>
                </li>
                
                
                
                <li>
                    <a href="/dycon-platform-documentation/projects/02-tutorials">First Steps</a>
                </li>
                
                
                
                <li>
                    <a href="/dycon-platform-documentation/projects/03-examples">Examples</a>
                </li>
                
                
                
                <li>
                    <a href="/dycon-platform-documentation/projects/04-download">Downloads</a>
                </li>
                
                
                
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="container" style="padding-top: 70px;">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading" style="padding: 0px 0"><h2><small>MATLAB tutorial of <a href="https://DeustoTech.github.io//dycon-platform-documentation/topic/Tp02"></a> :</small></h2>
                    <h1>First Example</h1>

					<span class="meta">Posted by:
					
						• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="https://DeustoTech.github.io/dycon-platform-documentation/author/JOroya"></a></span></span>
					
					</span>
					<div class="shadowbox">
						<p>To start this tutorial, write the following command in the MATLAB console
							<pre class="highlight"><code><span class="nb">open T0001_ControlProblemODE</span></code></pre>
						</p>
					</div>


                </div>
            </div>
		</div>


	</div>
</header>


<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>

<article>
    <div id="content" class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>En DyCon toolbox se ha definido el problema de control optimo a traves de la minimizacion de un funcional. De esta forma podemos resolver problemas del tipo</p>

<script type="math/tex; mode=display">\min_{U \in \Omega } \Psi(t,Y(T)) + \int_0^T L(t,Y,U) dt</script>

<p>sujecto a</p>

<script type="math/tex; mode=display">\dot{Y} = f(t,Y,U)</script>

<p>Se ha creado una interfaz simbolica para la definici�n de la dinamica. Por ello que deberemos definir un vector simbolico $Y$, que representara el estado de la dinamica, ademas de una vector simbolico $U$ que representara el vector de control.</p>

<p>Continuar�mos con un ejemplo para simplificar.</p>

<p>Supongamos que queremos encontrar el control que minimiza el funcional:</p>

<p>$$ y_1^2 + y_2^2 + \int_0^2 u_1^2 + u_2^2 dt</p>

<p>sujeto a</p>

<script type="math/tex; mode=display">\left( \begin{matrix}       \dot{y_1} \\       \dot{y_2}     \end{matrix} \right)    =     \left( \begin{matrix}               y_2     \\               y_2      \end{matrix} \right)</script>

<p>Deberemos inicializar los vectores de control y de estado.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Y</span> <span class="o">=</span> <span class="n">sym</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,[</span><span class="mi">2</span> <span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 
Y =
 
 y1
 y2
 

</code></pre></div></div>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">U</span> <span class="o">=</span> <span class="n">sym</span><span class="p">(</span><span class="s1">'u'</span><span class="p">,[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 
U =
 
u1
 

</code></pre></div></div>

<p>Una vez definidos podemos crear un vector simbolico con las misma dimensiones que el vector de estado. Este vector representara la dinamica del problema. Sigiendo la notacion utilizada al principio este vector ser� $f(t,Y,U)$</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">F</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>          <span class="p">;</span> <span class="k">...</span>
      <span class="o">-</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span> <span class="p">;</span>
</code></pre></div></div>

<p>Utilizando el contructor de ‘ode’</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dynamics</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
dynamics = 

  ode with properties:

     VectorState: [1x1 struct]
         Control: [1x1 struct]
         Dynamic: [1x1 struct]
       Condition: [2x1 double]
            Type: 'InitialCondition'
       FinalTime: 1
              dt: 0.1000
           label: ''
        RKMethod: @ode45
    RKParameters: {}
             PDE: 0
           tspan: [1x11 double]
            Udim: 1


</code></pre></div></div>

<p>Esta es una objecto que representa la ecuacion diferencial</p>

<p>mochos de los par�metros que definen la ecuacion han sido tomados por defecto. Espro ello que deberemos personalizarlo. Para que representa la dinamica que queramos. En este caso cambiaremos la condicion inicial y el intervalo en el tiempo</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dynamics</span><span class="o">.</span><span class="n">Condition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">dynamics</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
</code></pre></div></div>

<p>Un vez definido la dinamica podemos definir el funcional que minizaremos. Este funciona tendra que ser representado con las mismas variables con la que se ha definido la dinamica. Siguiendo la forma presentada en [1] deberemos definir las expresiones de $\Psi$ y $L$</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Psi</span> <span class="o">=</span> <span class="n">sym</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">L</span>   <span class="o">=</span> <span class="mf">0.005</span><span class="o">*</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="s1">'*U) +  Y.'</span><span class="o">*</span><span class="n">Y</span> <span class="p">;</span>
</code></pre></div></div>

<p>Ya habiendo creado la ecuacion diferencial y las expresiones para $\Psi$ y $L$, podemos definir el problemas de control optimo de la siguiente manera:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iP</span> <span class="o">=</span> <span class="n">OptimalControl</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span><span class="n">Psi</span><span class="p">,</span><span class="n">L</span><span class="p">);</span>
</code></pre></div></div>

<p>Este contiene informacion que puede ser de ayuda para la resolucion del problema. Es importante notar que no estamos resolviendo el problema. Simplemente lo estamos definiendo. Los solvers seran metodos que actuan sobre este objeto.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iP</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
iP = 

  OptimalControl with properties:

              J: [1x1 struct]
            ode: [1x1 ode]
        adjoint: [1x1 struct]
    hamiltonian: [1x1 symfun]
       gradient: [1x1 struct]
       solution: []
             YT: []


</code></pre></div></div>

<p>Uno de estos solver es el Gradient method. Este simplemnte calcula un gradiente con ayuda de la condiciones de optimalidad de primer orden extraida del principio del minimo de pontryagin. Para resolver el problema con este m�todo, simplemnte escribimos:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GradientMethod</span><span class="p">(</span><span class="n">iP</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    Solve with presicion: 

        We obtain: J(u) = 6.971327E-02

        mean(||dJ_i||) = 3.103674E-04

    With 8 iterations,     In 12.3172 seconds


</code></pre></div></div>

<p>Gradient Method crea un soluci�n para el problema.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iP</span><span class="o">.</span><span class="n">solution</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ans = 

  CPSolution with properties:

    precision: 3.1037e-04
         iter: 8
         time: 12.3172
     Yhistory: {1x8 cell}
     Uhistory: {1x8 cell}
     Jhistory: [0.6004 0.1614 0.0881 0.0724 0.0716 0.0699 0.0699 0.0697]
    dJhistory: {1x8 cell}
     Ehistory: [0 0.0388 0.0087 0.0026 0.0182 0.0014 0.0052 3.1037e-04]
     timeline: []
           du: []
     UOptimal: [101x1 double]
     JOptimal: 0.0697


</code></pre></div></div>

<p>Gracias a que la estructura es unica independiente del solver, podemos implentar funciones de visualizaci�n para todos tipo de solver. Un ejemplo de esto es la funcion plot aplicado a los objetos OptimalControl</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">iP</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://DeustoTech.github.io//dycon-platform-documentation/assets/imgs/tutorials/Tp02/T0001/copiaRM_01.png" alt="" /></p>



                <hr>

            </div>
        </div>
    </div>
</article>


<hr>


    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <div class="col-md-10">
        <ul class="list-inline text-center">
          <li>
            <img style="width: 200px;" src="/dycon-platform-documentation/img/logos/logo_DyCon.png " alt="">
          </li>
          <li>
            <img style="width: 250px;" src="/dycon-platform-documentation/img/logos/logo_CCM_subDerecha_v002.png " alt="">
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>


</body>

</html>
